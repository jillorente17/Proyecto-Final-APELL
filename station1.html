<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Station 1</title>
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet">
    <link rel="stylesheet" href="/styles/visual.css">
</head>
<body>

    <header class="site-header inicio">
        <div class="contenedor contenido-header">
            <div class="barra">
                <a href="/">
                    <img src="/images/logo.png" alt="Logotipo de Bienes Raices">
                </a>

                <div class="mobile-menu">
                    <a href="#navegacion" class="boton boton-verde">Menu
                    </a>
                </div>

                <nav id="navegacion" class="navegacion">
                    <a href="/">Home</a>
                    <a href="historics.html">Historics</a>
                    <a href="#Station-info">Station information</a>
                    <a href="#sim-ecoimp">Simulation and Economical Impact</a>
                </nav>
            </div>
        </div> <!-- contenedor -->
    </header>
<!------------------------------------------------------------------------------------------------------------------------------------------>
    
        <section class="fondo-sobrenosotros  centrar-texto">
            <div class="contenedor seccion color-fondo">
            <h2 id="Station-info">Station 1 Information</h2>
            <p>
                A water bed is added to the reactor that allows the reaction that will take place in this container to soften. To do this, the water solenoid valve is opened until reaching a reactor level of 50%. At this time, close the valve and finish adding water.</p>
            </div>
        </section>

    <main class="seccion contenedor">
        <div class="grid-informacion">
                

            <div class="contenedor-general centrar-texto">
                <p class="casillas-ss">In Place</p>
                <p class="casillas-metadato"id="in-place">1</p> 

                <p class="casillas-ss">Piston states:</p>
                <p class="casillas-metadato" id="estado-piston">1</p>

                <p class="casillas-ss">Tray: </p>
                <p class="casillas-metadato" id="bandeja-perturbacion">1</p>
            <!--":="DB1200".est1:"-->
            </div>
            

            <div class="centrar-texto">
                <br>
                <div class="contenedor-baliza">
                    <div class="luz-roja-apagada"><p class="opaco" id="color-luz-rojo">0</p></div>
                        <div class="luz-verde-apagada"><p class="opaco" id="color-luz-verde">1</p></div>
                </div>
            </div>
        </div>

        <div id="sim-ecoimp" class="contenedor centrar-texto">
            <h2>simulation and economical impact</h2>
               


        </div>
        <div class="informacion-station">
            <div class="centrar-texto">
                <h3>Simulation</h3>
                <div class="grid-informacion">

                <form action="">
                    <label for="fname" class="label-tank">Tank fill percentage</label><br>
                    <input type="number" id="porcentaje" name="fname" min="0" max="100"><br>
                    <button class="boton boton-amarillo" onclick="simulacion1()" type="button" >Ok</button>
                 
                    <p id="mensaje"></p>
                    <div class="estacion-simulacion">
                        <div class="piston-arriba-simulacion"></div>
                        <div class="bandeja-simulacion"></div>
                        <div class="piston-arriba-simulacion"></div>
                    </div>
                </form>
                    <div class="contenedor-baliza-simulacion">
                        <div class="luz-roja-apagada-simulacion"></div>
                        <div class="luz-verde-apagada-simulacion"></div>
                    </div>
            </div>
            </div>





            
            <div class="centrar-texto">
                <h3>Economical Impact</h3>
                <p>In this section, you will be able to calculate an estimated economical impact of losses of the simulation.</p>
                <p id="perdidas-simulacion1"></p>
            </div>
        </div>


    </main>










<!---------------------------------------------------------------------------------------------------------------------------------------------------->
    <footer class="site-footer seccion">
        <div class="contenedor contenedor-footer">
            <nav id="navegacion" class="navegacion">
                <a href="/">Home</a>
                <a href="#stations">Monitoring Stations</a>
                <a href="historics.html">Historics</a>
                <a href="#sim-ecoimp">Simulation and Economical Impact</a>
            </nav>
            <p class="copyright">Todos los Derechos Reservados 2020 &copy;</p>
        </div>
    </footer>
</body>
</html>
<script>

</script>
<script type="text/javascript">

    function controlador(){
    
    var colorRojo = document.getElementById('color-luz-rojo');
    var luzRoja = colorRojo.innerHTML;
    var balizaRoja = document.getElementsByTagName('div');

    var balizaPert = document.getElementById('bandeja-perturbacion');
    var lanzarAlerta= balizaPert.innerHTML;

    if(lanzarAlerta==2){
        alert('An error has ocurred')
    };

    if(luzRoja == 1){
        balizaRoja[8].setAttribute('class','luz-roja');
         //funcion alerta si es poca agua la que hay dentro del reactor
            alert("Warning, an error has ocurred");
            perdidasEcononomicas();

    }else{
        balizaRoja[8].setAttribute('class','luz-roja-apagada');
    };

    var colorVerde = document.getElementById('color-luz-verde');
    var luzVerde = colorVerde.innerHTML;
    var balizaVerde = document.getElementsByTagName('div');
    if(luzVerde == 1){
        
        balizaVerde[9].setAttribute('class','luz-verde');
    }else{
        balizaVerde[9].setAttribute('class','luz-verde-apagada');
    };
    };

funcionPrincipal=setInterval(controlador,1000);


    function simulacion1(){


        var porcentaje = document.getElementById('porcentaje').value;
            if (porcentaje<=0){
                alert('The fill percentage is not correct, please set another value');
            }else{

                //suponiendo que cada 1 segundo se llena el 10% del tanque
                var tiempoPor100 = (porcentaje/10);
                var tiempoTotal = Math.round(tiempoPor100);
                if( tiempoTotal<1){
                    tiempoTotal=1;
                }
                //Baliza de la simulación
                var colorRojoSim = document.getElementsByTagName('div');
                var colorVerdeSim= document.getElementsByTagName('div');

                //pistones de la simulación
                var pisD =  document.getElementsByTagName('div');
                var counter = 0;


                


                var i = setInterval(function(){
                    //pistones arriba
                    pisD[15].setAttribute('class','piston-arriba-simulacion');
                    pisD[17].setAttribute('class','piston-arriba-simulacion');

                    counter++; //contador de iteraciones
                    var load = Math.round((counter/tiempoTotal)*100); //porcentaje del proceso
                    document.getElementById("mensaje").innerHTML = "The tank is filling, wait for a while:"+load+"%"; //mensaje de espera




                    if(counter === tiempoTotal) {
                        clearInterval(i); //mata el contador del setInterval cuando llega al número de interaciones 
                        //pistones abajo
                        pisD[15].setAttribute('class','piston-abajo-simulacion');
                        pisD[17].setAttribute('class','piston-abajo-simulacion');
                        //Evalua el porcentaje y dice rojo si está por encima del 100%, verde si está por debajo
                        if(porcentaje>=100){
                            //encendido de luces si llega al 100% o más
                            colorVerdeSim[20].setAttribute('class','luz-verde-apagada-simulacion');
                            colorRojoSim[19].setAttribute('class','luz-roja-simulacion'); 

                            document.getElementById('color-luz-rojo').innerHTML="1";
                            document.getElementById('color-luz-verde').innerHTML="0";

                           
                        }
                        else{
                            //si es menor al 100%
                            colorVerdeSim[20].setAttribute('class','luz-verde-simulacion');
                            colorRojoSim[19].setAttribute('class','luz-roja-apagada-simulacion');  
                        }

                        //funcion para reiniciar todo
                        setTimeout(function Reset(){
                            pisD[15].setAttribute('class','piston-arriba-simulacion');
                            pisD[17].setAttribute('class','piston-arriba-simulacion');
                            colorVerdeSim[20].setAttribute('class','luz-verde-apagada-simulacion');
                            colorRojoSim[19].setAttribute('class','luz-roja-apagada-simulacion');
                            document.getElementById("mensaje").innerHTML = "" ;
                        }, 5000);
                    }
                }, 1000);
                        


          return(porcentaje)
    }
    };
        function perdidasEcononomicas(){
            clearInterval(funcionPrincipal);
            var porcentaje = document.getElementById('porcentaje').value;
            var porCiento = parseFloat(porcentaje/100);
            //Si el tanque tiene la capacidad de almacenar 10000L de agua o cualquier material
            var litrosTanque= parseFloat(10000/porCiento);
            var precioPerdidas=(litrosTanque*595314.38/100);
            precioPerdFinal=precioPerdidas.toFixed(2);
            precioEnMoneda=new Intl.NumberFormat("de-DE").format(precioPerdFinal);
            document.getElementById('perdidas-simulacion1').innerHTML="The losses of the accident were:"+"$"+precioEnMoneda+"COP"
            controlador();
        };
</script>