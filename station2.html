<!-- AWP_In_Variable Name='"DB1200".est2balizaV' -->
<!-- AWP_In_Variable Name='"DB1200".est2balizaR' -->
<!-- AWP_In_Variable Name='"DB1200".est2pistones' -->
<!-- AWP_In_Variable Name='"DB1200".boton2' -->
<!-- AWP_In_Variable Name='"DB1200".est2pt' -->
<!-- AWP_In_Variable Name='"DB1200".est2' -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Station 2</title>
    <!-- <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet"> -->
    <link rel="stylesheet" href="/fonts">
    <link rel="stylesheet" href="/styles/visual.css">
</head>
<body>

    <header class="site-header inicio">
        <div class="contenedor contenido-header">
            <div class="barra">
                <a href="/">
                    <img src="/images/logo.png" alt="Logotipo de Bienes Raices">
                </a>

                <div class="mobile-menu">
                    <a href="#navegacion" class="boton boton-verde">Menu
                    </a>
                </div>

                <nav id="navegacion" class="navegacion">
                    <a href="main.html">Home</a>
                    <a href="#Station-info">Station information</a>
                    <a href="#sim-ecoimp">Simulation and Economical Impact</a>
                </nav>
            </div>
        </div> <!-- contenedor -->
    </header>
<!------------------------------------------------------------------------------------------------------------------------------------------>
    
        <section class="fondo-sobrenosotros  centrar-texto">
            <div class="contenedor seccion color-fondo">
            <h2 id="Station-info">Station 2 Information</h2>
            <p>It starts the process of loading raw materials simultaneously by means of control valves, so that it is possible to regulate the flow of addition of each raw material, and thus maintain a control of the reaction. The measurement of the addition flow of each raw material is carried out by means of flow transmitters located in the lines of load to the reactor.
            </p>
            </div>
        </section>

    <main class="seccion contenedor">
        <div class="grid-informacion">
                

            <div class="contenedor-general centrar-texto">

                <p class="casillas-ss">Piston states:</p> 
                <p class="casillas-metadato">:="DB1200".est2pistones:</p>

                <p class="casillas-ss">Tray: </p>
                <p class="casillas-metadato" id="bandeja-perturbacion">:="DB1200".est2:</p>
            </div>
<!--:="DB1200".est2:-->
            <div class="centrar-texto">
                <div class="contenedor-baliza">
                    <div class="luz-roja-apagada"><p class="opaco" id="color-luz-rojo">=:"DB1200".est2balizaR:</p></div>
                        <div class="luz-verde-apagada"><p class="opaco" id="color-luz-verde">=:"DB1200".est2balizaV</p></div>
                </div>
            </div>
        </div>

        <div id="sim-ecoimp" class="contenedor centrar-texto">
            <h2>simulation and economical impact</h2>
            <div class="informacion-station">
                <div class="centrar-texto">
                    <h3>Simulation</h3>
                    <div class="grid-informacion">
    
                    <form action="">
                        <label for="fname" class="label-tank">Percentage of Fats</label>
                        <input type="number" id="porcentaje-mat1" name="fname" min="0" max="100">
                        <label for="fname" class="label-tank">Percentage of pure sebum</label>
                        <input type="number" id="porcentaje-mat2" name="fname" min="0" max="100">
                        <label for="fname" class="label-tank">Percentage of caustic soda</label>
                        <input type="number" id="porcentaje-mat3" name="fname" min="0" max="100">
                        <label for="fname" class="label-tank">Percentage of soda lye</label>
                        <input type="number" id="porcentaje-mat4" name="fname" min="0" max="100">
                        <label for="fname" class="label-tank">Percentage of salt dissolution</label>
                        <input type="number" id="porcentaje-mat5" name="fname" min="0" max="100">
                        
                        <button class="boton boton-amarillo" id="porcent" onclick="simulacion2Mat1()" type="button" >Ok</button>
                        <p id="mensaje1"></p>


                        <div class="estacion-simulacion">
                            <div class="piston-arriba-simulacion2"></div>
                            <div class="bandeja-simulacion2"></div>
                            <div class="piston-arriba-simulacion2"></div>
                        </div>
                    </form>
                        <div class="contenedor-baliza-simulacion">
                            <div class="luz-roja-apagada-simulacion"></div>
                            <div class="luz-verde-apagada-simulacion"></div>
                        </div>
                </div>
                </div>













                <div class="centrar-texto">
                    <h3>Economical Impact</h3>
                    <p>In this section, you will be able to calculate an estimated economical impact of losses of the simulation.</p>
                    
                    <p class="par1"></p>
                    <p id="perdidas-mat1"></p>
                    
                    <p class="par2"></p>
                    <p id="perdidas-mat2"></p>
                    
                    <p class="par3"></p>
                    <p id="perdidas-mat3"></p>
                    
                    <p class="par4"></p>
                    <p id="perdidas-mat4"></p>
                   
                    <p class="par5"></p>
                    <p id="perdidas-mat5"></p>
                    
                    <p class="par6"></p>
                    <p id="perdidas-mat-t"></p>

                    <p id="porcentaje-PLC" name="DB1200.est2pt">:="DB1200".est2pt:</p>
                    <p id="push" name="DB1200.boton2">:="DB1200".boton2:</p>
                        
                </div>
            </div>
        </div>



    </main>










<!---------------------------------------------------------------------------------------------------------------------------------------------------->
    <footer class="site-footer seccion">
        <div class="contenedor contenedor-footer">
            <nav id="navegacion" class="navegacion">
                <a href="/">Home</a>
                <a href="#stations">Monitoring Stations</a>
                <a href="historics.html">Historics</a>
                <a href="#sim-ecoimp">Simulation and Economical Impact</a>
            </nav>
            <p class="copyright">Todos los Derechos Reservados 2020 &copy; </p>
        </div>
    </footer>

</body>
</html>






<script>
  </script>
<script type="text/javascript">
    function controlador(){
    'use strict';
    document.addEventListener('DOMContentLoaded', function(){

    var colorRojo = document.getElementById('color-luz-rojo');
    var luzRoja = colorRojo.innerHTML;
    var balizaRoja = document.getElementsByTagName('div');
    var balizaPert = document.getElementById('bandeja-perturbacion');
    var lanzarAlerta= balizaPert.innerHTML;
    if(lanzarAlerta == 3){
        alert('An error has ocurred')
        
    };
    
    if(luzRoja == 1){
        balizaRoja[8].setAttribute('class','luz-roja');
    }else{
        balizaRoja[8].setAttribute('class','luz-roja-apagada');
    };

    var colorVerde = document.getElementById('color-luz-verde');
    var luzVerde = colorVerde.innerHTML;
    var balizaVerde = document.getElementsByTagName('div');
    if(luzVerde == 1){
        balizaVerde[9].setAttribute('class','luz-verde');
    }else{
        balizaVerde[9].setAttribute('class','luz-verde-apagada');
    };
    
});
};
funcionPrincipal=setInterval(controlador(),1000)


    function simulacion2Mat1(){


        
        var porcentajeMat1 = document.getElementById('porcentaje-mat1').value;
        var porcentajeMat2 = document.getElementById('porcentaje-mat2').value;
        var porcentajeMat3 = document.getElementById('porcentaje-mat3').value;
        var porcentajeMat4 = document.getElementById('porcentaje-mat4').value;
        var porcentajeMat5 = document.getElementById('porcentaje-mat5').value;


            if (porcentajeMat1<=0 ||  
             porcentajeMat2<=0 || 
             porcentajeMat3<=0 ||  
             porcentajeMat4<=0 || 
             porcentajeMat5<=0){

                alert('The percentage of material 1 is not correct, please set another value');
            }
            else{
                var colorRojoSim = document.getElementsByTagName('div');
                var colorVerdeSim= document.getElementsByTagName('div');
                var pisD =  document.getElementsByTagName('div');
                var tiempoTotal1 = Math.round(porcentajeMat1/10);
                var tiempoTotal2 = tiempoTotal1+Math.round(porcentajeMat2/10);
                var tiempoTotal3 = tiempoTotal2+Math.round(porcentajeMat3/10);
                var tiempoTotal4 = tiempoTotal3+Math.round(porcentajeMat4/10);
                var tiempoTotal =   tiempoTotal4+Math.round(porcentajeMat5/10);
                var counter = 0;     


                var i = setInterval(function(){
                    counter++; //contador de iteraciones
                    var load = Math.round((counter/tiempoTotal)*100); //porcentaje del proceso
                    document.getElementById("mensaje1").innerHTML = "We are adding the materials, wait a while:"+load+"%";
                    porcentaje1 = porcentajeMat1;
                    porcentaje2 = porcentajeMat2;
                    porcentaje3 = porcentajeMat3;
                    porcentaje4 = porcentajeMat4;
                    porcentaje5 = porcentajeMat5;
                    porcentajeTotal= ((+porcentaje1 + +porcentaje2)+(+porcentajeMat3 + +porcentajeMat4)+ (+porcentajeMat5));
                    
                    //porcentajes de materiales traducirlo a tiempo (5s)
                    tempPLC = (porcentajeTotal/100*5);
                    document.getElementById("porcentaje-PLC").innerHTML = tempPLC
                    document.getElementById("push").innerHTML = 1;
                    if(counter === tiempoTotal) {
                        clearInterval(i);

                                colorVerdeSim[20].setAttribute('class','luz-verde-simulacion');
                                colorRojoSim[19].setAttribute('class','luz-roja-simulacion');
                                document.getElementById("mensaje1").innerHTML = "" ;
                            
                            setTimeout(()=>{
                            if(
                            Math.abs(porcentajeMat1-porcentajeMat2)>15 || Math.abs(porcentajeMat1-porcentajeMat3)>15 ||
                            Math.abs(porcentajeMat1-porcentajeMat4)>15 || Math.abs(porcentajeMat1-porcentajeMat5)>15 ||
                            Math.abs(porcentajeMat2-porcentajeMat3)>15 || Math.abs(porcentajeMat2-porcentajeMat4)>15 || 
                            Math.abs(porcentajeMat2-porcentajeMat5)>15 || Math.abs(porcentajeMat3-porcentajeMat4)>15 ||
                            Math.abs(porcentajeMat3-porcentajeMat5)>15 || Math.abs(porcentajeMat4-porcentajeMat5)>15){

                                colorVerdeSim[20].setAttribute('class','luz-verde-apagada-simulacion');
                                colorRojoSim[19].setAttribute('class','luz-roja-simulacion');  
                                alert('An error has ocurred: The diference between the materials is significant');
                                pisD[15].setAttribute('class','piston-abajo-simulacion2');
                                pisD[17].setAttribute('class','piston-abajo-simulacion2'); 
                                // escribir en el plc
                                document.getElementById('color-luz-rojo').innerHTML="1";
                                document.getElementById('color-luz-verde').innerHTML="0";
                                
                                
                                
                                perdidasEcononomicas();
                            }
                            else if((porcentajeTotal)>50){
                                colorVerdeSim[20].setAttribute('class','luz-verde-apagada-simulacion');
                                colorRojoSim[19].setAttribute('class','luz-roja-simulacion');  
                                alert('An error has ocurred');
                                pisD[15].setAttribute('class','piston-abajo-simulacion2');
                                pisD[17].setAttribute('class','piston-abajo-simulacion2'); 
                                //escribir en el plc
                                document.getElementById('color-luz-rojo').innerHTML="1";
                                document.getElementById('color-luz-verde').innerHTML="0";
                                perdidasEcononomicas();
                            }
                            else{
                                colorVerdeSim[20].setAttribute('class','luz-verde-simulacion');
                                colorRojoSim[19].setAttribute('class','luz-roja-apagada-simulacion'); 
                                pisD[15].setAttribute('class','piston-abajo-simulacion2');
                                pisD[17].setAttribute('class','piston-abajo-simulacion2'); 
                                //escribir en el plc
                                document.getElementById('color-luz-rojo').innerHTML="0";
                                document.getElementById('color-luz-verde').innerHTML="1";
                            }
                                setTimeout(function Reset(){

                                    pisD[15].setAttribute('class','piston-arriba-simulacion2');
                                    pisD[17].setAttribute('class','piston-arriba-simulacion2');
                                    colorVerdeSim[20].setAttribute('class','luz-verde-apagada-simulacion');
                                    colorRojoSim[19].setAttribute('class','luz-roja-apagada-simulacion');
                                    document.getElementById("mensaje1").innerHTML = "" ;
                                    document.querySelector('.par1').innerHTML=""
                                    document.getElementById('perdidas-mat1').innerHTML=""
                                    document.querySelector('.par2').innerHTML=""
                                    document.getElementById('perdidas-mat2').innerHTML=""
                                    document.querySelector('.par3').innerHTML=""
                                    document.getElementById('perdidas-mat3').innerHTML=""
                                    document.querySelector('.par4').innerHTML=""
                                    document.getElementById('perdidas-mat4').innerHTML=""
                                    document.querySelector('.par5').innerHTML=""
                                    document.getElementById('perdidas-mat5').innerHTML=""
                                    document.querySelector('.par6').innerHTML=""
                                    document.getElementById('perdidas-mat-t').innerHTML=""

                                }, 5000);
                            
                            
                            },1000);
                            //funcion para reiniciar todo
                            
                    };
                }, 1000);
                        



    }
    };
    function perdidasEcononomicas(){
            clearInterval(funcionPrincipal);
            var porcentajeMat1 = document.getElementById('porcentaje-mat1').value;
            var porcentajeMat2 = document.getElementById('porcentaje-mat2').value;
            var porcentajeMat3 = document.getElementById('porcentaje-mat3').value;
            var porcentajeMat4 = document.getElementById('porcentaje-mat4').value;
            var porcentajeMat5 = document.getElementById('porcentaje-mat5').value;
            var porCiento1 = parseFloat(porcentajeMat1/100);
            var porCiento2 = parseFloat(porcentajeMat2/100);
            var porCiento3 = parseFloat(porcentajeMat3/100);
            var porCiento4 = parseFloat(porcentajeMat4/100);
            var porCiento5 = parseFloat(porcentajeMat5/100);



            var perMat1 = ((porCiento1*305)*(+2016666.67 + +7500000))/305;
            precioPerdFinal1=perMat1.toFixed(2);
            precioEnMoneda1= new Intl.NumberFormat("de-DE").format(precioPerdFinal1);
            document.querySelector('.par1').innerHTML="The losses of the material 1:"
            document.getElementById('perdidas-mat1').innerHTML="$"+precioEnMoneda1+"COP"

            var perMat2 = ((porCiento2*120)*92918.52)/120;
            precioPerdFinal2=perMat2.toFixed(2);
            precioEnMoneda2= new Intl.NumberFormat("de-DE").format(precioPerdFinal2);
            document.querySelector('.par2').innerHTML="The losses of the material 2:"
            document.getElementById('perdidas-mat2').innerHTML="$"+precioEnMoneda2+"COP"

            var perMat3 = ((porCiento3*41)*4346000)/55;
            precioPerdFinal3=perMat3.toFixed(2);
            precioEnMoneda3= new Intl.NumberFormat("de-DE").format(precioPerdFinal3);
            document.querySelector('.par3').innerHTML="The losses of the material 3:"
            document.getElementById('perdidas-mat3').innerHTML="$"+precioEnMoneda3+"COP"

            var perMat4 = ((porCiento1*82)*287000)/55;
            precioPerdFinal4=perMat4.toFixed(2);
            precioEnMoneda4= new Intl.NumberFormat("de-DE").format(precioPerdFinal4);
            document.querySelector('.par4').innerHTML="The losses of the material 4:"
            document.getElementById('perdidas-mat4').innerHTML="$"+precioEnMoneda4+"COP"

            var perMat5 = ((porCiento5*185)*(+20300000+ +595314.38))/185;
            precioPerdFinal5=perMat5.toFixed(2);
            precioEnMoneda5= new Intl.NumberFormat("de-DE").format(precioPerdFinal5);
            document.querySelector('.par5').innerHTML="The losses of the material 5:"
            document.getElementById('perdidas-mat5').innerHTML="$"+precioEnMoneda5+"COP"
            
            precioTotal= (+perMat1 + +perMat2)+(+perMat3+ +perMat4)+(+perMat5);
            precioTot=precioTotal.toFixed(2);
            precioEnMonedaT= new Intl.NumberFormat("de-DE").format(precioTot);
            document.querySelector('.par6').innerHTML="The total losses:"
            document.getElementById('perdidas-mat-t').innerHTML="$"+precioEnMonedaT+"COP"
            
            
            
            setTimeout(()=>{
            document.getElementById('color-luz-rojo').innerHTML="0";
            document.getElementById('color-luz-verde').innerHTML="1";
            controlador();
            },10000);
        };




</script>

<script src="Jquery/jquery.min.js">
</script>


 <script>
     //tener datos 
            $(document).ready(function () {


            // Enviar la información de los botones sin recargar la página.

            $().ajaxStart(function () {
                $('#loading').show();
                $('#result').hide(); 
            }).ajaxStop(function () {
                $('#loading').hide();
                $('#result').fadeIn('fast');
            });

            $('#porcent').click(function () {
                $.ajax({
                    type: 'POST',
                    url: $(this).attr('action'),
                    data: $(this).serialize(),
                    
                success: function (data) {
                    $('#result').html(data);
                }
                })

            return false;
            
            })});


 </script>